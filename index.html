<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.1.1"><link rel="apple-touch-icon" sizes="180x180" href="/images/head.jpg"><link rel="icon" type="image/png" sizes="32x32" href="/images/head.jpg"><link rel="icon" type="image/png" sizes="16x16" href="/images/head.jpg"><link rel="mask-icon" href="/images/logo.svg" color="#222"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/lib/font-awesome/css/all.min.css"><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:"hencent.github.io",root:"/",scheme:"Gemini",version:"7.8.0",exturl:!1,sidebar:{position:"left",display:"post",padding:18,offset:12,onmobile:!1},copycode:{enable:!1,show_result:!1,style:null},back2top:{enable:!0,sidebar:!1,scrollpercent:!0},bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!1,mediumzoom:!1,lazyload:!1,pangu:!1,comments:{style:"tabs",active:null,storage:!0,lazyload:!1,nav:null},algolia:{hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!1,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1},motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},path:"search.xml"}</script><meta property="og:type" content="website"><meta property="og:title" content="PenguinCat&#39;s Blog"><meta property="og:url" content="https://hencent.github.io/index.html"><meta property="og:site_name" content="PenguinCat&#39;s Blog"><meta property="og:locale" content="en_US"><meta property="article:author" content="Binjie Zhang"><meta name="twitter:card" content="summary"><link rel="canonical" href="https://hencent.github.io/"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!0,isPost:!1,lang:"en"}</script><title>PenguinCat's Blog</title><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="Toggle navigation bar"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span><h1 class="site-title">PenguinCat's Blog</h1><span class="logo-line-after"><i></i></span></a><p class="site-subtitle" itemprop="description">可持久化想要喵</p></div><div class="site-nav-right"><div class="toggle popup-trigger"></div></div></div><nav class="site-nav"><ul id="menu" class="main-menu menu"><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li></ul></nav></div></header><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span>0%</span></div><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content index posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en"><link itemprop="mainEntityOfPage" href="https://hencent.github.io/2020/10/17/20340/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/head.jpg"><meta itemprop="name" content="Binjie Zhang"><meta itemprop="description" content=""></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="PenguinCat's Blog"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/2020/10/17/20340/" class="post-title-link" itemprop="url">Efficient similar region search with deep metric learning</a></h2><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">Posted on</span> <time title="Created: 2020-10-17 15:30:06 / Modified: 18:46:13" itemprop="dateCreated datePublished" datetime="2020-10-17T15:30:06+08:00">2020-10-17</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/UrbanComputing/" itemprop="url" rel="index"><span itemprop="name">UrbanComputing</span></a></span></span></div></header><div class="post-body" itemprop="articleBody"><h1 id="文章主要解决什么问题"><a href="#文章主要解决什么问题" class="headerlink" title="文章主要解决什么问题"></a>文章主要解决什么问题</h1><p>在区域搜索中，存在两个问题：</p><ol><li>相似度衡量需要更合理的方法</li><li>搜索的时间复杂度极高</li></ol><h1 id="解决的思路是什么"><a href="#解决的思路是什么" class="headerlink" title="解决的思路是什么"></a>解决的思路是什么</h1><ol><li>针对相似度衡量问题，定义了一种可以既可以衡量区域内部属性，又可以衡量区域内 item 的相对位置。</li><li>针对搜索时间复杂度较高的问题，使用了一种特征预处理及分支限界法来解决。</li></ol><h1 id="核心的知识点有哪些"><a href="#核心的知识点有哪些" class="headerlink" title="核心的知识点有哪些"></a>核心的知识点有哪些</h1><ol><li>三元 CNN 网络 -&gt; 用于比较排名</li><li>基于分支限界思想的 Efficient subwindow search 的搜索算法<h1 id="模型分块说明"><a href="#模型分块说明" class="headerlink" title="模型分块说明"></a>模型分块说明</h1></li><li>排名学习模型（用于衡量相对相似性）<ol><li>三元组网络<br>三元组 CNN 网络在图像识别领域用的比较多，应用于图像的排序度量。像正常的 CNN 一样使用各种 kernal 来捕获局部特征。CNN 的最后一层输出的特征（不是全连接层之后得到的一个标量）内容被记为 Net(*)。在解决排名问题时这样训练：任意挑选一个查询样本 x<sub>q</sub> ，找出一个与其类别相同的正样本 x<sub>+</sub> 以及一个与其类别不同的负样本 x<sub>-</sub>。<br>那么正负样本与查询样本之间的距离即为<script type="math/tex;mode=display">d_{+}=\left\|\operatorname{Net}\left(x_{q}\right)-\operatorname{Net}\left(x_{+}\right)\right\|_{2} \text { and } d_{-}=\left\|\operatorname{Net}\left(x_{q}\right)-\operatorname{Net}\left(x_{-}\right)\right\|_{2}</script>显然，如果我们想要这个模型能够正确排名，就需要 d<sub>+</sub> 尽可能小，d<sub>-</sub> 尽可能大。所以就有了 loss function 为：<script type="math/tex;mode=display">\mathcal{L}=\sum_{\left(x_{q}, x_{+}, x_{-}\right)} \max \left\{0, d_{+}-d_{-}+\delta\right\}+\lambda\|\operatorname{Net}(\cdot)\|_{2}</script></li><li>本论文中的使用方法<br>对于本文的区域问题，首先将区域划分成一个个小格子（类比像素），区域特征 $R \in \mathbb{R}^{w \times h \times d}$ 经过 CNN Net 之后提取到的信息为 $X \in \mathbb{R}^{w^{<em>} \times h^{</em>} \times K}$，然后再使用一个聚合函数 g(*) （此处为 max-pooling）获取这个区域信息的一维表示 $\mathbf{v}=g(X), \mathbf{v} \in \mathbb{R}^{1 \times K}$。所以本文中对应的 d<sub>+</sub> 和 d<sub>-</sub> 为：$d_{+}=\left|\mathbf{v}_{q}-\mathbf{v}_{+}\right|_{2}$ and $d_{-}=\left|\mathbf{v}_{q}-\mathbf{v}_{-}\right|_{2}$。这样就可以进行 CNN Net 的训练了<br>训练完之后，区域相似度可以表示为：$\operatorname{sim}\left(R_{1}, R_{2}\right)=\frac{1}{1+\left|\mathbf{v}_{1}-\mathbf{v}_{2}\right|_{2}}$</li><li>训练 robust 的三元组网络<br>由于没有标好标记的区域相似性数据，文中提出一种自监督的学习策略，通过学习自相似性来使模型具备 robust，无需再获取标签。<br>所谓的 robust 可以理解为，一个原始区域和一个由前者经少量噪声和移动而产生的区域应被视为是相似的。<br>按照这个思路，随机挑选一个区域作为查询区域，加上少量的噪声和移动作为正样本；随机选取其他区域作为负样本、原查询区域加上过多的噪声和移动作为难例负样本。<br>这样，模型学到的特征对小的噪声和移动也就具有了 robust。<ol><li>基于比率的训练损失<br>不同区域中的目标数差别很大，这可能会导致一些训练数据组的损失值很大，盖过了其它训练数据的影响。所以修改 loss function 为：<script type="math/tex;mode=display">\mathcal{L}=\sum_{\left(R_{q}, R_{+}, R_{-}\right)} \max \left\{0, \frac{d_{+}}{d_{+}+d_{-}}-\delta\right\}+\lambda\|\operatorname{Net}(\cdot)\|_{2}</script></li></ol></li></ol></li><li><p>区域搜寻算法（解决搜索时间极长的问题）</p><ol><li>通过共享 CNN 计算结果转化问题<br>计算相似性的时候，每选一个候选区域，就要通过 CNN 来计算它的特征。如果要查询很多次，特别是有部分区域重叠的时候，就会有许多重复计算。那干脆直接预处理最大的区域，然后直接找特征相似的区域。找到特征相似区域之后，再反向找出原区域即可。<br><img src="/2020/10/17/20340/1.png" alt></li><li><p>分支限界法求精准结果</p><ol><li>基本概念与设定<br><img src="/2020/10/17/20340/2.png" alt><br>候选特征区域的位置可以用一个参数化元组表示：$(t^<em>,b^</em>,l^<em>,r^</em>)$ ，其中$1 \leq l^<em> \leq r^</em> \leq H^<em>$，且$1 \leq b^</em> \leq t^<em> \leq W^</em>$。<br>搜索空间：一个特征区域位置的集合${S}={\bar t} \times {\bar b} \times {\bar l} \times {\bar r}$，其中${\bar t}=[t_{min}^{<em>},t_{max}^{</em>}],{\bar b}=[b_{min}^{<em>},b_{max}^{</em>}],{\bar l}=[l_{min}^{<em>},l_{max}^{</em>}],{\bar r}=[r_{min}^{<em>},r_{max}^{</em>}]$，使得$\forall (t^<em>,b^</em>,l^<em>,r^</em>) \in {S}$，满足$t^<em> \in {\bar t},b^</em> \in {\bar b},l^<em> \in {\bar l},r^</em> \in {\bar r}$.<br>搜索空间的概念如上图中灰色区域所示。候选区域也就是 $X_{\cap} \subset X_{c} \subset X_{\cup}, \forall X_{c} \in \mathcal{S}$<br>本方法中，我们定义给定查询 X<sub>q</sub> 时，一个候选空间 S 距离的下界，也就是说：$\hat{f}\left(\mathcal{S} \mid \mathcal{X}_{q}\right) \leq\left|g\left(\mathcal{X}_{q}\right)-g\left(\mathcal{X}_{c}\right)\right|_{2}, \forall \mathcal{X}_{c} \in \mathcal{S}$。直观的来看，$\hat{f}\left(\mathcal{S} \mid \mathcal{X}_{q}\right)$越小，那么 $\exists {X}_c \in {S}$ 是 X<sub>q</sub> 的一个 top-N 区域的机会越大。<ol><li>分支定界搜索<br>本题中的 g 是 max-pooling 函数，它是单调递增的（如果区域A包含区域B，那么g(A) &gt;= g(B)）。所以<script type="math/tex;mode=display">g\left(\mathcal{X}_{\cap}\right) \leq g\left(\mathcal{X}_{c}\right) \leq g\left(\mathcal{X}_{\mathrm{U}}\right), i . e_{.}, \mathbf{v}_{\cap}[k] \leq \mathbf{v}_{c}[k] \leq \mathbf{v}_{\mathrm{U}}[k], \forall k \in[1, K]</script>而 $\left|g\left(\mathcal{X}_{q}\right)-g\left(\mathcal{X}_{c}\right)\right|_{2}$ 可以用 $\sqrt{\sum_{k \in[1, K]}\left(\mathbf{v}_{q}[k]-\mathbf{v}_{c}[k]\right)^{2}}$ 表示，那么根据上述单调的结论，可以得到如下两个条件：<script type="math/tex;mode=display">(i) \quad\left(\mathbf{v}_{q}[k]-\mathbf{v}_{c}[k]\right)^{2} \geq\left(\mathbf{v}_{q}[k]-\mathbf{v}_{\cap}[k]\right)^{2}, \quad \text { if } \mathbf{v}_{\cap}[k] \geq \mathbf{v}_{q}[k]</script><script type="math/tex;mode=display">(i i) \quad\left(\mathbf{v}_{q}[k]-\mathbf{v}_{c}[k]\right)^{2} \geq\left(\mathbf{v}_{q}[k]-\mathbf{v}_{U}[k]\right)^{2}, \quad \text { if } \mathbf{v}_{\cup}[k] \leq \mathbf{v}_{q}[k]</script>所以我们的下界就可以表示为 $\hat{f}\left(\mathcal{S} \mid \mathcal{X}_{q}\right)=\sqrt{\sum_{k_{1}}\left(\mathbf{v}_{q}\left[k_{1}\right]-\mathbf{v}_{\cap}\left[k_{1}\right]\right)^{2}+\sum_{k_{2}}\left(\mathbf{v}_{q}\left[k_{2}\right]-\mathbf{v}_{\cup}\left[k_{2}\right]\right)^{2}}$。<br>这样就可以进行分支限界的搜索了</li><li>搜索过程<br><img src="/2020/10/17/20340/3.png" alt><br>这个搜索过程借鉴了一个叫 Efficient subwindow search 的目标定位算法，拆分的过程如下图所示。通过不停的拆分，每次选择可能性最大的区域进一步搜索。每次拆分，都会排除掉比较多的区域，能够快速定位到答案区域。<br>我自己画图试了试各种拆分，发现即使每次拆分的都不是最合适的方向，但是并不会漏掉答案存在的可能性。<strong>尤其需要注意的是，它每次拆分并不是把图一剖为二，而是按照下图的方式拆分</strong> 务必看懂下图才能知道为什么不会漏解。<br><img src="/2020/10/17/20340/4.png" alt></li></ol></li></ol></li><li><p>求模糊结果<br>限制队列 Q 的大小，当长度过长时，丢掉队列尾。可以在只损失一点准确率的情况下提升效率。</p></li></ol></li></ol></div><footer class="post-footer"><div class="post-eof"></div></footer></article><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en"><link itemprop="mainEntityOfPage" href="https://hencent.github.io/2020/10/11/23796/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/head.jpg"><meta itemprop="name" content="Binjie Zhang"><meta itemprop="description" content=""></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="PenguinCat's Blog"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/2020/10/11/23796/" class="post-title-link" itemprop="url">leetcode-416-分割等和子集</a></h2><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">Posted on</span> <time title="Created: 2020-10-11 10:22:14 / Modified: 10:28:05" itemprop="dateCreated datePublished" datetime="2020-10-11T10:22:14+08:00">2020-10-11</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/leetcode/" itemprop="url" rel="index"><span itemprop="name">leetcode</span></a></span></span></div></header><div class="post-body" itemprop="articleBody"><p>首先，这种挑选是一个 NP 完全问题，不应期望该问题有多项式时间复杂度的解法。<br>必须尝试非多项式时间复杂度的算法，例如时间复杂度与元素大小相关的动态规划。</p><p>这可以看成是一个需要装满的背包问题。在考虑前 i 个物品的情况下，能不能装满 j。</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">205</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxv = <span class="number">10005</span>;</span><br><span class="line"><span class="keyword">bool</span> dp[maxn][maxv];</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">canPartition</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (nums.<span class="built_in">size</span>() &lt; <span class="number">2</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> val : nums) &#123;</span><br><span class="line">            sum += val;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (sum &amp; <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">int</span> target = sum / <span class="number">2</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">memset</span>(dp, <span class="literal">false</span>, <span class="keyword">sizeof</span>(dp));</span><br><span class="line">        dp[<span class="number">0</span>][<span class="number">0</span>] = <span class="literal">true</span>;</span><br><span class="line">        dp[<span class="number">0</span>][nums[<span class="number">0</span>]] = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; nums.<span class="built_in">size</span>(); ++i) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; maxv; ++j) &#123;</span><br><span class="line">                dp[i][j] = dp[i<span class="number">-1</span>][j];</span><br><span class="line">                <span class="keyword">if</span> (j - nums[i] &gt;= <span class="number">0</span> &amp;&amp; dp[i<span class="number">-1</span>][j-nums[i]]) &#123;</span><br><span class="line">                	dp[i][j] = <span class="literal">true</span>;</span><br><span class="line">				&#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nums.<span class="built_in">size</span>(); ++i) &#123;</span><br><span class="line">            <span class="keyword">if</span> (dp[i][target]) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></div><footer class="post-footer"><div class="post-eof"></div></footer></article><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en"><link itemprop="mainEntityOfPage" href="https://hencent.github.io/2020/10/10/25217/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/head.jpg"><meta itemprop="name" content="Binjie Zhang"><meta itemprop="description" content=""></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="PenguinCat's Blog"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/2020/10/10/25217/" class="post-title-link" itemprop="url">Learning region similarity over spatial knowledge graphs with hierarchical types and semantic relations</a></h2><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">Posted on</span> <time title="Created: 2020-10-10 20:30:49 / Modified: 21:13:37" itemprop="dateCreated datePublished" datetime="2020-10-10T20:30:49+08:00">2020-10-10</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Search/" itemprop="url" rel="index"><span itemprop="name">Search</span></a></span></span></div></header><div class="post-body" itemprop="articleBody"><h1 id="文章主要解决什么问题"><a class="markdownIt-Anchor" href="#文章主要解决什么问题"></a> 文章主要解决什么问题</h1><p>空间知识图谱中的一种常见应用（也是一种常见问题）是相似区域搜索。相似区域搜索需要解决两个关键的问题：</p><ul><li>如何对空间知识图谱中的 entity 做合理的 embedding，以提取有用的信息</li><li>如何衡量衡量区域相似度<br>本文解决了上述两个问题</li></ul><h1 id="解决的思路是什么"><a class="markdownIt-Anchor" href="#解决的思路是什么"></a> 解决的思路是什么</h1><ul><li>利用 entity 的类别层次信息，即类别树的关系，合理进行 embedding</li><li>使用 CNN 来融合一个区域内的所有 entity 信息，因为 CNN 可以获取区域特征，变相保留了相对位置信息</li></ul><h1 id="核心的知识点有哪些"><a class="markdownIt-Anchor" href="#核心的知识点有哪些"></a> 核心的知识点有哪些</h1><ul><li>embedding</li><li>feature engineering</li><li>CNN</li></ul><h1 id="模型分块说明"><a class="markdownIt-Anchor" href="#模型分块说明"></a> 模型分块说明</h1><ol><li><p>如何对 entity 进行合理的 embedding<br>embedding 的原则是：具有相似层次类型的 / 语义相似的 entity 对应该越相近。现有的知识图谱 embedding 方法基于各种 Trans，可能不能很好的提取类别关系（如大类别包含小类别等关系）。本文作者提出：借助 entity 的类型层次和语义相似度，定义距离，用于 embedding.<br><img src="/2020/10/10/25217/1.png" alt="img"></p><ul><li>层次类型信息<br>思想是：所有类别中，与该类别有关的类别数量越少，该类别所包含的信息量越大（信息熵）。两个 entity 在类别上的层次相似度，可以看作是规格化的最近公共类别节点的信息量。<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>C</mi><mrow><mi>h</mi><mi>t</mi></mrow></msub><mo>=</mo><mi>γ</mi><mo>×</mo><mrow><mo fence="true">(</mo><mn>1</mn><mo>−</mo><mfrac><mrow><mi>c</mi><mi mathvariant="normal">sim</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>h</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo></mrow><mrow><mi>max</mi><mo>⁡</mo><mi>I</mi><mi>C</mi><mo stretchy="false">(</mo><mo>⋅</mo><mo stretchy="false">)</mo></mrow></mfrac><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">C_{h t}=\gamma \times\left(1-\frac{c \operatorname{sim}(h, t)}{\max I C(\cdot)}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.7777700000000001em;vertical-align:-.19444em"></span><span class="mord mathdefault" style="margin-right:.05556em">γ</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.40003em;vertical-align:-.95003em"></span><span class="minner"><span class="mopen delimcenter" style="top:0"><span class="delimsizing size3">(</span></span><span class="mord">1</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mop">max</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathdefault" style="margin-right:.07847em">I</span><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="mopen">(</span><span class="mord">⋅</span><span class="mclose">)</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">c</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mop"><span class="mord mathrm">s</span><span class="mord mathrm">i</span><span class="mord mathrm">m</span></span><span class="mopen">(</span><span class="mord mathdefault">h</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathdefault">t</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.936em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0"><span class="delimsizing size3">)</span></span></span></span></span></span></span></p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>c</mi><mi mathvariant="normal">sim</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>h</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo>=</mo><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mi>max</mi><mo>⁡</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi>I</mi><mi>C</mi><mo stretchy="false">(</mo><mi>c</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">c \operatorname{sim}(h, t)=\begin{aligned}\max &amp; I C(c)\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault">c</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mop"><span class="mord mathrm">s</span><span class="mord mathrm">i</span><span class="mord mathrm">m</span></span><span class="mopen">(</span><span class="mord mathdefault">h</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathdefault">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.5000000000000002em;vertical-align:-.5000000000000002em"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1em"><span style="top:-3em"><span class="pstrut" style="height:2.84em"></span><span class="mord"><span class="mop">max</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.5000000000000002em"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1em"><span style="top:-3.16em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mord mathdefault" style="margin-right:.07847em">I</span><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="mopen">(</span><span class="mord mathdefault">c</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.5000000000000002em"><span></span></span></span></span></span></span></span></span></span></span></span></p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>I</mi><mi>C</mi><mo stretchy="false">(</mo><mi>c</mi><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><mi>log</mi><mo>⁡</mo><mi>p</mi><mo stretchy="false">(</mo><mi>c</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">I C(c)=-\log p(c)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault" style="margin-right:.07847em">I</span><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="mopen">(</span><span class="mord mathdefault">c</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">−</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mop">lo<span style="margin-right:.01389em">g</span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathdefault">p</span><span class="mopen">(</span><span class="mord mathdefault">c</span><span class="mclose">)</span></span></span></span></span></p>其中 p© 表示访问所有层次的类别时，遇到类别 c 的概率。显然这个概率越大，类别 c 所包含的信息越少。</li><li>语义相似度信息<br>根据两个 entity 所对应的类别在类结构图上所相距的跳数，获得语义信息。具体的跳数越远，相似度越小，反之越大。<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>S</mi><mrow><mi>h</mi><mi>t</mi></mrow></msub><mo>=</mo><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><mi>θ</mi><msup><mo stretchy="false">)</mo><mrow><mi>m</mi><mi>h</mi><mo>+</mo><mn>1</mn><mo>−</mo><mi>h</mi><mi>o</mi><mi>p</mi><mo stretchy="false">(</mo><mi>h</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">S_{h t}=(1+\theta)^{m h+1-h o p(h, t)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.188em;vertical-align:-.25em"></span><span class="mord mathdefault" style="margin-right:.02778em">θ</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.938em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mord mathdefault mtight">h</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight">h</span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">p</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight">h</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">t</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span></span></p></li></ul><p>综上，embedding 的关于层次类型及语义的 distance 可以定义为</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>D</mi><mrow><mi>h</mi><mi>t</mi></mrow></msub><mo>=</mo><mfrac><msub><mi>C</mi><mrow><mi>h</mi><mi>t</mi></mrow></msub><msub><mi>S</mi><mrow><mi>h</mi><mi>t</mi></mrow></msub></mfrac></mrow><annotation encoding="application/x-tex">D_{h t}=\frac{C_{h t}}{S_{h t}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.02778em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.19633em;vertical-align:-.8360000000000001em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>那么 embedding 的 loss function 就是</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="script">L</mi><mi>e</mi></msub><mo>=</mo><munder><mo>∑</mo><mrow><mo stretchy="false">(</mo><mi>h</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo>∈</mo><msup><mi mathvariant="script">E</mi><mo>⊕</mo></msup></mrow></munder><msup><mrow><mo fence="true">(</mo><mrow><mo fence="true">∥</mo><msub><mi>h</mi><mi>e</mi></msub><mo>−</mo><msub><mi>t</mi><mi>e</mi></msub><mo fence="true">∥</mo></mrow><mo>−</mo><msub><mi>D</mi><mrow><mi>h</mi><mi>t</mi></mrow></msub><mo fence="true">)</mo></mrow><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\mathcal{L}_{e}=\sum_{(h, t) \in \mathcal{E}^{\oplus}}\left(\left\|h_{e}-t_{e}\right\|-D_{h t}\right)^{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">e</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.5660100000000003em;vertical-align:-1.516005em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em"><span style="top:-1.808995em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">h</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">t</span><span class="mclose mtight">)</span><span class="mrel mtight">∈</span><span class="mord mtight"><span class="mord mtight"><span class="mord mathcal mtight" style="margin-right:.08944em">E</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.7026642857142857em"><span style="top:-2.786em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">⊕</span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.0500049999999996em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.516005em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0">(</span><span class="minner"><span class="mopen delimcenter" style="top:0">∥</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">e</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">e</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0">∥</span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.02778em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.954008em"><span style="top:-3.2029em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></span></p></li><li><p>如何衡量区域相似度<br>传统方法可能是将一个区域内所有 entity 的特征叠加，但是这样就失去了语义信息。作者的思路是，模仿计算机图像处理中，使用 CNN 来提取区域特征。这样，就可以在利用各个 entity 特征的同时，融合他们的相对位置信息。<br>使用 d+ 和 d- 分别表示经过 CNN Net 之后正负样本的 distance，那么 CNN 的 loss function 就可以表示为</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="script">L</mi><mi>t</mi></msub><mo>=</mo><munder><mo>∑</mo><mrow><mo fence="true">(</mo><msub><mi>R</mi><mi>q</mi></msub><mo separator="true">,</mo><msub><mi>R</mi><mo>+</mo></msub><mo separator="true">,</mo><msub><mi>R</mi><mo>−</mo></msub><mo fence="true">)</mo></mrow></munder><mi>max</mi><mo>⁡</mo><mrow><mo fence="true">{</mo><mn>0</mn><mo separator="true">,</mo><mfrac><msub><mi>d</mi><mo>+</mo></msub><mrow><msub><mi>d</mi><mo>+</mo></msub><mo>−</mo><msub><mi>d</mi><mo>−</mo></msub></mrow></mfrac><mo>−</mo><mi>δ</mi><mo fence="true">}</mo></mrow><mo>+</mo><mi>λ</mi><mi mathvariant="normal">∥</mi><mi>N</mi><mi>e</mi><mi>t</mi><mo stretchy="false">(</mo><mo>⋅</mo><mo stretchy="false">)</mo><msub><mi mathvariant="normal">∥</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{t}=\sum_{\left(R_{q}, R_{+}, R_{-}\right)} \max \left\{0, \frac{d_{+}}{d_{+}-d_{-}}-\delta\right\}+\lambda\|N e t(\cdot)\|_{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.2805559999999999em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.9883249999999997em;vertical-align:-1.538325em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em"><span style="top:-1.808995em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0"><span class="mtight">(</span></span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.00773em">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.16454285714285716em"><span style="top:-2.357em;margin-left:-.00773em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03588em">q</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2818857142857143em"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.00773em">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.2736642857142857em"><span style="top:-2.357em;margin-left:-.00773em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">+</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.20252142857142857em"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.00773em">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.2736642857142857em"><span style="top:-2.357em;margin-left:-.00773em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">−</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.20252142857142857em"><span></span></span></span></span></span></span><span class="mclose mtight delimcenter" style="top:0"><span class="mtight">)</span></span></span></span></span></span><span style="top:-3.0500049999999996em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.538325em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mop">max</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen delimcenter" style="top:0"><span class="delimsizing size3">{</span></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.25833100000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">+</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.208331em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.25833100000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.208331em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.25833100000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">+</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.208331em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.894331em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord mathdefault" style="margin-right:.03785em">δ</span><span class="mclose delimcenter" style="top:0"><span class="delimsizing size3">}</span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault">λ</span><span class="mord">∥</span><span class="mord mathdefault" style="margin-right:.10903em">N</span><span class="mord mathdefault">e</span><span class="mord mathdefault">t</span><span class="mopen">(</span><span class="mord">⋅</span><span class="mclose">)</span><span class="mord"><span class="mord">∥</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></span></p><p>那么每一个区域的特征向量就可以表示为 <code>v = Net(POIS)</code><br>这样就可以计算区域间的相似度了</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">rsim</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><msub><mi>R</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>R</mi><mn>2</mn></msub><mo fence="true">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>−</mo><msub><mrow><mo fence="true">∥</mo><msub><mi>v</mi><mn>1</mn></msub><mo>−</mo><msub><mi>v</mi><mn>2</mn></msub><mo fence="true">∥</mo></mrow><mn>2</mn></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">\operatorname{rsim}\left(R_{1}, R_{2}\right)=\frac{1}{1-\left\|v_{1}-v_{2}\right\|_{2}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mop"><span class="mord mathrm">r</span><span class="mord mathrm">s</span><span class="mord mathrm">i</span><span class="mord mathrm">m</span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen delimcenter" style="top:0">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:.00773em">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.00773em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.00773em">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.00773em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0">)</span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.30714em;vertical-align:-.9857em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0">∥</span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0">∥</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151408em"><span style="top:-2.4003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.29969999999999997em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.9857em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p></li></ol><h1 id="其他"><a class="markdownIt-Anchor" href="#其他"></a> 其他</h1><p>第一次阅读 区域相似度 相关的论文，感觉对于 feature 的处理需要很多经验和技巧，有待积累。</p></div><footer class="post-footer"><div class="post-eof"></div></footer></article><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en"><link itemprop="mainEntityOfPage" href="https://hencent.github.io/2020/10/05/22492/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/head.jpg"><meta itemprop="name" content="Binjie Zhang"><meta itemprop="description" content=""></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="PenguinCat's Blog"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/2020/10/05/22492/" class="post-title-link" itemprop="url">leetcode-18-四数之和</a></h2><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">Posted on</span> <time title="Created: 2020-10-05 09:33:38 / Modified: 09:41:36" itemprop="dateCreated datePublished" datetime="2020-10-05T09:33:38+08:00">2020-10-05</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/leetcode/" itemprop="url" rel="index"><span itemprop="name">leetcode</span></a></span></span></div></header><div class="post-body" itemprop="articleBody"><p>最朴素的做法是 O(n^4) 的暴力算法，显然不行。</p><p>第一个优化的思路，前三个数循环，然后最后一个数 (target - 前三个数) 用 set 判断是否存在。复杂度是 O(n^3 * logn)</p><p>第二个优化思路。前两个数循环，然后用两个 L R 指针分别指向 j+1 和 n-1。根据四个数和的大小左右移动即可。这样复杂度是 O(n^3)。</p><p>左右指针是一个常见的用法，特此记录。</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt; <span class="title">fourSum</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; nums, <span class="keyword">int</span> target)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt; ans;</span><br><span class="line">        <span class="keyword">if</span> (nums.<span class="built_in">size</span>() &lt; <span class="number">4</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> ans;</span><br><span class="line">        &#125;</span><br><span class="line">        sort(nums.<span class="built_in">begin</span>(), nums.<span class="built_in">end</span>());</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nums.<span class="built_in">size</span>() - <span class="number">3</span>; ++i) &#123;</span><br><span class="line">            <span class="keyword">if</span> (i &gt; <span class="number">0</span> &amp;&amp; nums[i] == nums[i<span class="number">-1</span>]) &#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = i+<span class="number">1</span>; j &lt; nums.<span class="built_in">size</span>() - <span class="number">2</span>; ++j) &#123;</span><br><span class="line">                <span class="keyword">if</span> (j &gt; i+<span class="number">1</span> &amp;&amp; nums[j] == nums[j<span class="number">-1</span>]) &#123;</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">int</span> l = j+<span class="number">1</span>, r = nums.<span class="built_in">size</span>()<span class="number">-1</span>;</span><br><span class="line">                <span class="keyword">while</span>(l &lt; r) &#123;</span><br><span class="line">                    <span class="keyword">int</span> tmpsum = nums[i] + nums[j] + nums[l] + nums[r];</span><br><span class="line">                    <span class="keyword">if</span> (tmpsum == target) &#123;</span><br><span class="line">                        ans.push_back(&#123;nums[i], nums[j], nums[l], nums[r]&#125;);</span><br><span class="line">                        <span class="keyword">while</span> (l &lt; r &amp;&amp; nums[l] == nums[l+<span class="number">1</span>]) &#123;</span><br><span class="line">                            l++;</span><br><span class="line">                        &#125;</span><br><span class="line">                        l++;</span><br><span class="line">                        <span class="keyword">while</span> (l &lt; r &amp;&amp; nums[r] == nums[r<span class="number">-1</span>]) &#123;</span><br><span class="line">                            r--;</span><br><span class="line">                        &#125;</span><br><span class="line">                        r--;</span><br><span class="line">                    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (tmpsum &lt; target) &#123;</span><br><span class="line">                        l++;</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        r--;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;         </span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></div><footer class="post-footer"><div class="post-eof"></div></footer></article><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en"><link itemprop="mainEntityOfPage" href="https://hencent.github.io/2020/10/04/54545/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/head.jpg"><meta itemprop="name" content="Binjie Zhang"><meta itemprop="description" content=""></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="PenguinCat's Blog"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/2020/10/04/54545/" class="post-title-link" itemprop="url">Exploring the Urban Region-of-Interest through the Analysis of Online Map Search Queries</a></h2><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">Posted on</span> <time title="Created: 2020-10-04 11:51:46 / Modified: 13:37:01" itemprop="dateCreated datePublished" datetime="2020-10-04T11:51:46+08:00">2020-10-04</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/UrbanComputing/" itemprop="url" rel="index"><span itemprop="name">UrbanComputing</span></a></span></span></div></header><div class="post-body" itemprop="articleBody"><h1 id="文章主要解决什么问题"><a class="markdownIt-Anchor" href="#文章主要解决什么问题"></a> 文章主要解决什么问题</h1><p>识别 Region of Interest 并分析所设计的各类 topic。<br>ROI 与 POI 不同，他包含了多种 POI ，有多种 function / categories。往大了做，可以以一个商圈的粗粒度来使用，往小了做，可以看成是融合了几种类型的综合店铺。</p><h1 id="解决的思路是什么"><a class="markdownIt-Anchor" href="#解决的思路是什么"></a> 解决的思路是什么</h1><ul><li>利用 density-based 聚类方法来识别 ROI</li><li>利用 topic model 分析查询历史，挖掘更多 ROI 的信息</li></ul><h1 id="核心的知识点有哪些"><a class="markdownIt-Anchor" href="#核心的知识点有哪些"></a> 核心的知识点有哪些</h1><ul><li>clustering</li><li>topic model</li></ul><h1 id="模型分块说明"><a class="markdownIt-Anchor" href="#模型分块说明"></a> 模型分块说明</h1><ul><li>clustering<br>将城区划分为细粒度的网格，利用 PageRank 分析各个网格的受欢迎程度。再利用 Heat Value 等指标对网格进行聚类融合，得到不同的 ROI。</li><li>topic model<br>NLP 相关，此处跳过。</li></ul><h1 id="其他"><a class="markdownIt-Anchor" href="#其他"></a> 其他</h1><p>这篇论文的数据分析部分很值得一看。</p><ul><li>topic model<br>以北京市为例，通过 topic 的空间分布(user 被 topic 所属地点吸引)、topic 所包含的 POI 类别、topic 是时间分布这三个指标，可以分析出一些场景。如：去工作、家庭晚宴、周末购物等场景，可以为城市商业规划提供指导。</li><li>Topic-Aware Visitor Inference for ROIs<br>识别 topic 相关的 ROI 访问者来源。例如国贸的访客有好几种 topic 组成，每种 topic 对应的访客的到访目的都不一样。<br><img src="/2020/10/04/54545/img1.png" alt="img1"><br>也可以和地域分析结合在一起。餐饮购物相关的 topic 从北京东部吸引的客流较少，因为北京东部也有许多购物中心。同时，对于海淀区的游客来说，Topic 7 没有 Topic 15那么有吸引力，因为那里的人更喜欢五道口的餐馆。</li></ul><p>这种不同的 topic 吸引了不同的用户、不同 topic 吸引用户的地理范围不同，和我们之前讨论的思路是非常契合的。我认为完全有理由将这种思路用在有多种商业类别的单一店铺上。</p></div><footer class="post-footer"><div class="post-eof"></div></footer></article><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en"><link itemprop="mainEntityOfPage" href="https://hencent.github.io/2020/09/26/5848/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/head.jpg"><meta itemprop="name" content="Binjie Zhang"><meta itemprop="description" content=""></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="PenguinCat's Blog"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/2020/09/26/5848/" class="post-title-link" itemprop="url">Jointly Learning Explainable Rules for Recommendation with Knowledge Graph</a></h2><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">Posted on</span> <time title="Created: 2020-09-26 16:49:50 / Modified: 17:15:38" itemprop="dateCreated datePublished" datetime="2020-09-26T16:49:50+08:00">2020-09-26</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/KnowledgeGraph/" itemprop="url" rel="index"><span itemprop="name">KnowledgeGraph</span></a></span></span></div></header><div class="post-body" itemprop="articleBody"><h1 id="文章主要解决什么问题"><a class="markdownIt-Anchor" href="#文章主要解决什么问题"></a> 文章主要解决什么问题</h1><p>作者提出推荐系统面临两个问题：</p><ul><li>可解释性不足</li><li>传统 path-based 方法需要手动定义 meta-path，即需要人工干预<br>本文解决了上述问题</li></ul><h1 id="解决的思路是什么"><a class="markdownIt-Anchor" href="#解决的思路是什么"></a> 解决的思路是什么</h1><ul><li>将知识图中可解释规则的归纳与用规则引导神经推荐模型的构建相结合。</li><li>该框架鼓励两个模块相互补充，以产生有效和可解释的推荐。</li></ul><h1 id="核心的知识点有哪些"><a class="markdownIt-Anchor" href="#核心的知识点有哪些"></a> 核心的知识点有哪些</h1><ul><li>Multi-Task</li><li>KG</li></ul><h1 id="模型分块说明"><a class="markdownIt-Anchor" href="#模型分块说明"></a> 模型分块说明</h1><ol><li>规则学习模块<br>如果实体之间满足了什么关系，那么很有可能明显的蕴含着一些关系。<br>hard-selection 和 soft-selection</li><li>推荐模块<br>以 item 特征向量作为附加输入，以提高推荐性能，并对推荐进行解释。引入了一个共享规则权重向量 w 表示每个规则在预测用户偏好方面的重要性，并显示了每个规则在预测项对关联方面的有效性。</li></ol></div><footer class="post-footer"><div class="post-eof"></div></footer></article><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en"><link itemprop="mainEntityOfPage" href="https://hencent.github.io/2020/09/22/45893/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/head.jpg"><meta itemprop="name" content="Binjie Zhang"><meta itemprop="description" content=""></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="PenguinCat's Blog"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/2020/09/22/45893/" class="post-title-link" itemprop="url">Semantic Path based Personalized Recommendation on Weighted Heterogeneous Information Networks</a></h2><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">Posted on</span> <time title="Created: 2020-09-22 21:58:27 / Modified: 22:47:33" itemprop="dateCreated datePublished" datetime="2020-09-22T21:58:27+08:00">2020-09-22</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/KnowledgeGraph/" itemprop="url" rel="index"><span itemprop="name">KnowledgeGraph</span></a></span></span></div></header><div class="post-body" itemprop="articleBody"><h1 id="文章主要解决什么问题"><a href="#文章主要解决什么问题" class="headerlink" title="文章主要解决什么问题"></a>文章主要解决什么问题</h1><p>利用知识图谱做推荐系统。传统知识图谱中，path-based 方法没有考虑边上的权值，在一些场景如电影评分中，是有很大问题的。传统方法只是知道用户与它有交互，判定为用户对它有偏爱，但是实际上用户可能打了低分。</p><h1 id="解决的思路是什么"><a href="#解决的思路是什么" class="headerlink" title="解决的思路是什么"></a>解决的思路是什么</h1><ul><li>给知识图谱的边引入权值</li><li>使用语义模块对不同元路径设定重要性权重与个性化权重<h1 id="核心的知识点有哪些"><a href="#核心的知识点有哪些" class="headerlink" title="核心的知识点有哪些"></a>核心的知识点有哪些</h1></li><li>带权知识图谱</li><li>个性化权重<h1 id="模型分块说明"><a href="#模型分块说明" class="headerlink" title="模型分块说明"></a>模型分块说明</h1></li><li>带权知识图谱<br>元路径上有不同的属性（例如不同的打分），针对此做一个拆分，拆成原子路径。例如，假设 user 对 item 的打分的范围是 1~5，那么就用五条路径分别表示用户打1分、2分，…， 5分。这样就可以用朴素的 PathSim 来计算相似度了。具体来说：<ol><li>利用现有的基于路径的度量方法，评估基于每个原子元路径的相似性</li><li>求和加权元路径中所有原子元路径的相似性，作为原始元路径的相似度。</li></ol></li><li><p>语义模块</p><ol><li><p>单路径推荐</p><script type="math/tex;mode=display">\begin{array}{l}
Q_{u, i, r}^{(l)}=\sum_{v} S_{u, v}^{(l)} \times E_{v, i, r} \\
E_{v, i, r}=\left\{\begin{array}{ll}
1 & R_{v, i}=r \\
0 & \text { others }
\end{array}\right.
\end{array}</script><p>其中 $Q_{u, i, r}^{(l)}$ 表示在给定路径 l 上， user u 对 item i 评分为 r 的强度。<br>这样就可以计算出预估的用户评分</p><script type="math/tex;mode=display">\hat{R}_{u, i}^{(l)}=\sum_{r=1}^{N} r \times \frac{Q_{u, i, r}^{(l)}}{\sum_{k=1}^{N} Q_{u, i, k}^{(l)}}</script></li><li><p>多路径推荐</p><ol><li>为所有用户学习统一的权重<br>对于所有用户，我们为每个元路径分配一个统一的权重。使用 square error 求解<script type="math/tex;mode=display">\hat{R}_{u, i}=\sum_{l=1}^{|\mathcal{P}|} \boldsymbol{w}^{(l)} \times \hat{R}_{u, i}^{(l)}</script><script type="math/tex;mode=display">\begin{aligned}
\min _{\boldsymbol{w}} \mathcal{L}_{1}(\boldsymbol{w}) &=\frac{1}{2}\left\|Y \odot\left(R-\sum_{l=1}^{|\mathcal{P}|} \boldsymbol{w}^{(l)} \hat{R}^{(l)}\right)\right\|_{2}^{2} \\
&+\frac{\lambda_{0}}{2}\|\boldsymbol{w}\|_{2}^{2} \\
\text { s.t. } & \boldsymbol{w} \geq 0
\end{aligned}</script></li><li>为每个用户学习个性化的权重<br>每个用户对不同路径有自己的权重。<script type="math/tex;mode=display">\hat{R}_{u, i}=\sum_{l=1}^{|\mathcal{P}|} W_{u}^{(l)} \times \hat{R}_{u, i}^{(l)}</script><script type="math/tex;mode=display">\begin{aligned}
\min _{W} \mathcal{L}_{2}(W) &=\frac{1}{2}\left\|Y \odot\left(R-\sum_{l=1}^{|\mathcal{P}|} \operatorname{diag}\left(W^{(l)}\right) \hat{R}^{(l)}\right)\right\|_{2}^{2} \\
&+\frac{\lambda_{0}}{2}\|W\|_{2}^{2} \\
\text {s.t.} & W \geq 0
\end{aligned}</script></li><li>解决数据少的用户的稀疏/冷启动问题<br>对于冷启动 user 和 item 来说，训练样本通常不足以进行权值学习。根据相似用户权重偏好的一致性规则，一个用户的路径权重应该与其相似用户的路径权重一致。对于信息较少的用户，其路径权重可以从其相似用户的权重中获得。因此，使用一个正则化项，它迫使用户的权值与他的相似用户的权值的平均值保持一致。也就是稍加修改了 2.2 中的式子<script type="math/tex;mode=display">\sum_{l=1}^{|\mathcal{P}|}\left\|W^{(l)}-\bar{S}^{(l)} W^{(l)}\right\|_{2}^{2}</script><script type="math/tex;mode=display">\begin{aligned}
\min _{W} \mathcal{L}_{3}(W) &=\frac{1}{2}\left\|Y \odot\left(R-\sum_{l=1}^{|\mathcal{P}|} \operatorname{diag}\left(W^{(l)}\right) \hat{R}^{(l)}\right)\right\|_{2}^{2} \\
&+\frac{\lambda_{1}}{2} \sum_{l=1}^{|\mathcal{P}|}\left\|W^{(l)}-\bar{S}^{(l)} W^{(l)}\right\|_{2}^{2}+\frac{\lambda_{0}}{2}\|W\|_{2}^{2} \\
\text {s.t.} & W \geq 0
\end{aligned}</script></li></ol></li></ol></li></ul><h1 id="存在的问题"><a href="#存在的问题" class="headerlink" title="存在的问题"></a>存在的问题</h1><p>没有定义用户相似性怎么算，我也没想出来</p><h1 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h1><p>我觉得本文说的非常有道理。很多文中都提到过这样的问题，user item 有交互并不能表示 user 喜欢这个 item.</p></div><footer class="post-footer"><div class="post-eof"></div></footer></article><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en"><link itemprop="mainEntityOfPage" href="https://hencent.github.io/2020/09/20/64074/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/head.jpg"><meta itemprop="name" content="Binjie Zhang"><meta itemprop="description" content=""></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="PenguinCat's Blog"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/2020/09/20/64074/" class="post-title-link" itemprop="url">leetcode-CLP22-数字游戏</a></h2><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">Posted on</span> <time title="Created: 2020-09-20 20:27:11" itemprop="dateCreated datePublished" datetime="2020-09-20T20:27:11+08:00">2020-09-20</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i> </span><span class="post-meta-item-text">Edited on</span> <time title="Modified: 2020-10-05 09:35:43" itemprop="dateModified" datetime="2020-10-05T09:35:43+08:00">2020-10-05</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/leetcode/" itemprop="url" rel="index"><span itemprop="name">leetcode</span></a></span></span></div></header><div class="post-body" itemprop="articleBody"><p>将前 i+1 个元素变成递增为 1 的序列，等价于先将每个 nums[j] 减去 j，再将前 i+1 个元素变相同。<br>如果希望将这些元素全部变成 k，那么代价就是 ∣nums[j]−k∣ 的和。一个比较显然的结论是，当 k 为所有元素的中位数时，这个和达到最小值。<br>所以使用两个优先队列来维护。<br>q0为大顶堆，q1为小顶堆。q0的元素个数与q1元素个数相同或多一个。</p><ul><li>当元素的个数为奇数时，代价就是q1的元素之和减去q0的元素之和再加上中位数（即q0的堆顶元素）</li><li>当元素的个数为偶数时，代价就是q1的元素之和减去q0的元素之和</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1000000007</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line">    <span class="built_in">priority_queue</span>&lt;<span class="keyword">int</span>, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;, less&lt;<span class="keyword">int</span>&gt;&gt; q0;</span><br><span class="line">    <span class="built_in">priority_queue</span>&lt;<span class="keyword">int</span>, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;, greater&lt;<span class="keyword">int</span>&gt;&gt; q1;</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; ans;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">numsGame</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (nums.<span class="built_in">size</span>() == <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> &#123;<span class="number">0</span>&#125;;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nums.<span class="built_in">size</span>(); ++i) &#123;</span><br><span class="line">            nums[i] -= i;</span><br><span class="line">        &#125;</span><br><span class="line">        q0.push(<span class="built_in">min</span>(nums[<span class="number">0</span>], nums[<span class="number">1</span>]));</span><br><span class="line">        q1.push(<span class="built_in">max</span>(nums[<span class="number">0</span>], nums[<span class="number">1</span>]));</span><br><span class="line">        ans.push_back(<span class="number">0</span>);</span><br><span class="line">        ans.push_back(<span class="built_in">abs</span>(nums[<span class="number">1</span>]-nums[<span class="number">0</span>]));</span><br><span class="line">        <span class="keyword">int</span> sum0 = q0.top();</span><br><span class="line">        <span class="keyword">int</span> sum1 = q1.top();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; nums.<span class="built_in">size</span>(); ++i) &#123;</span><br><span class="line">            <span class="keyword">if</span> ((i &amp; <span class="number">1</span>) == <span class="number">0</span>) &#123; <span class="comment">// 奇数个 </span></span><br><span class="line">                <span class="keyword">if</span> (nums[i] &lt;= q1.top()) &#123;</span><br><span class="line">                    sum0 += nums[i];</span><br><span class="line">                    q0.push(nums[i]);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    sum0 += q1.top();</span><br><span class="line">                    sum1 -= q1.top();</span><br><span class="line">                    q0.push(q1.top());</span><br><span class="line">                    q1.pop();</span><br><span class="line">                    sum1 += nums[i];</span><br><span class="line">                    q1.push(nums[i]);</span><br><span class="line">                &#125;</span><br><span class="line">                sum0 %= mod;</span><br><span class="line">                sum1 %= mod;</span><br><span class="line">                ans.push_back((sum1-sum0+q0.top()+mod)%mod);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (nums[i] &gt;= q0.top()) &#123;</span><br><span class="line">                    sum1 += nums[i];</span><br><span class="line">                    q1.push(nums[i]);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    sum0 -= q0.top();</span><br><span class="line">                    sum1 += q0.top();</span><br><span class="line">                    q1.push(q0.top());</span><br><span class="line">                    q0.pop();</span><br><span class="line">                    sum0 += nums[i];</span><br><span class="line">                    q0.push(nums[i]);</span><br><span class="line">                &#125;</span><br><span class="line">                sum0 %= mod;</span><br><span class="line">                sum1 %= mod;</span><br><span class="line">                ans.push_back((sum1-sum0+mod)%mod);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></div><footer class="post-footer"><div class="post-eof"></div></footer></article><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en"><link itemprop="mainEntityOfPage" href="https://hencent.github.io/2020/09/14/65156/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/head.jpg"><meta itemprop="name" content="Binjie Zhang"><meta itemprop="description" content=""></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="PenguinCat's Blog"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/2020/09/14/65156/" class="post-title-link" itemprop="url">Personalized entity recommendation: a heterogeneous information network approach</a></h2><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">Posted on</span> <time title="Created: 2020-09-14 22:41:02 / Modified: 23:12:37" itemprop="dateCreated datePublished" datetime="2020-09-14T22:41:02+08:00">2020-09-14</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/KnowledgeGraph/" itemprop="url" rel="index"><span itemprop="name">KnowledgeGraph</span></a></span></span></div></header><div class="post-body" itemprop="articleBody"><h1 id="文章主要解决什么问题"><a class="markdownIt-Anchor" href="#文章主要解决什么问题"></a> 文章主要解决什么问题</h1><p>利用 path-based 的知识图谱方法解决个性化推荐问题</p><h1 id="解决的思路是什么"><a class="markdownIt-Anchor" href="#解决的思路是什么"></a> 解决的思路是什么</h1><ul><li>利用知识图谱中的元路径，使用 PathSim 来衡量 user 对某一 item 的兴趣。这一过程将简单的 user-item 交互历史转换为了更有现实意义的兴趣打分</li><li>利用用户分组的思想，以用户组的方式训练，避免了使用全局用户数据而不能有效个性化，也避免了因为单个用户数据较少而带来的欠拟合。</li></ul><h1 id="核心的知识点有哪些"><a class="markdownIt-Anchor" href="#核心的知识点有哪些"></a> 核心的知识点有哪些</h1><ul><li>MF</li><li>分簇</li></ul><h1 id="模型分块说明"><a class="markdownIt-Anchor" href="#模型分块说明"></a> 模型分块说明</h1><ol><li>提取用户兴趣<br>首先根据预定义的元路径，结合 user-item 交互历史，算出 user 对 item 的兴趣扩散。兴趣扩散得分公式 PathSim 为：</li></ol><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi>s</mi><mrow><mo fence="true">(</mo><msub><mi>u</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>e</mi><mi>j</mi></msub><mo>∣</mo><mi mathvariant="script">P</mi><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mo>=</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><munder><mo>∑</mo><mrow><mi>e</mi><mo>∈</mo><mi mathvariant="script">I</mi></mrow></munder><mfrac><mrow><mn>2</mn><mo>×</mo><msub><mi>R</mi><mrow><msub><mi>u</mi><mi>i</mi></msub><mo separator="true">,</mo><mi>e</mi></mrow></msub><mo>×</mo><mrow><mo fence="true">∣</mo><mrow><mo fence="true">{</mo><msub><mi>p</mi><mrow><mi>e</mi><mo>∼</mo><msub><mi>e</mi><mi>j</mi></msub></mrow></msub><mo>:</mo><msub><mi>p</mi><mrow><mi>e</mi><mo>∼</mo><msub><mi>e</mi><mi>j</mi></msub></mrow></msub><mo>∈</mo><msup><mi mathvariant="script">P</mi><mo mathvariant="normal">′</mo></msup><mo fence="true">}</mo></mrow><mo fence="true">∣</mo></mrow></mrow><mrow><mrow><mo fence="true">∣</mo><mrow><mo fence="true">{</mo><msub><mi>p</mi><mrow><mi>e</mi><mo>∼</mo><mi>e</mi></mrow></msub><mo>:</mo><msub><mi>p</mi><mrow><mi>e</mi><mo>∼</mo><mi>e</mi></mrow></msub><mo>∈</mo><msup><mi mathvariant="script">P</mi><mo mathvariant="normal">′</mo></msup><mo fence="true">}</mo></mrow><mo fence="true">∣</mo></mrow><mo>+</mo><mrow><mo fence="true">∣</mo><mrow><mo fence="true">{</mo><msub><mi>p</mi><mrow><msub><mi>e</mi><mi>j</mi></msub><mo>∼</mo><msub><mi>e</mi><mi>j</mi></msub></mrow></msub><mo>:</mo><msub><mi>p</mi><mrow><msub><mi>e</mi><mi>j</mi></msub><mo>∼</mo><msub><mi>e</mi><mi>j</mi></msub></mrow></msub><mo>∈</mo><msup><mi mathvariant="script">P</mi><mo mathvariant="normal">′</mo></msup><mo fence="true">}</mo></mrow><mo fence="true">∣</mo></mrow></mrow></mfrac></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned} &amp; s\left(u_{i}, e_{j} \mid \mathcal{P}\right) \\ =&amp; \sum_{e \in \mathcal{I}} \frac{2 \times R_{u_{i}, e} \times\left|\left\{p_{e \sim e_{j}}: p_{e \sim e_{j}} \in \mathcal{P}^{\prime}\right\}\right|}{\left|\left\{p_{e \sim e}: p_{e \sim e} \in \mathcal{P}^{\prime}\right\}\right|+\left|\left\{p_{e_{j} \sim e_{j}}: p_{e_{j} \sim e_{j}} \in \mathcal{P}^{\prime}\right\}\right|} \end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:4.723706em;vertical-align:-2.111853em"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.611853em"><span style="top:-5.3738529999999995em"><span class="pstrut" style="height:3.602em"></span><span class="mord"></span></span><span style="top:-3.111853em"><span class="pstrut" style="height:3.602em"></span><span class="mord"><span class="mrel">=</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.111853em"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.611853em"><span style="top:-5.3738529999999995em"><span class="pstrut" style="height:3.602em"></span><span class="mord"><span class="mord"></span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen delimcenter" style="top:0">(</span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord"><span class="mord mathcal" style="margin-right:.08222em">P</span></span><span class="mclose delimcenter" style="top:0">)</span></span></span></span><span style="top:-3.111853em"><span class="pstrut" style="height:3.602em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em"><span style="top:-1.8556639999999998em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">e</span><span class="mrel mtight">∈</span><span class="mord mtight"><span class="mord mathcal mtight" style="margin-right:.07382em">I</span></span></span></span></span><span style="top:-3.0500049999999996em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.321706em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6019999999999999em"><span style="top:-2.24801em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0">∣</span><span class="minner"><span class="mopen delimcenter" style="top:0">{</span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">e</span><span class="mrel mtight">∼</span><span class="mord mathdefault mtight">e</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">:</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">e</span><span class="mrel mtight">∼</span><span class="mord mathdefault mtight">e</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord"><span class="mord"><span class="mord mathcal" style="margin-right:.08222em">P</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.6778919999999999em"><span style="top:-2.9890000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0">}</span></span><span class="mclose delimcenter" style="top:0">∣</span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.86199em"><span style="top:-2.2559899999999997em"><span class="pstrut" style="height:2.606em"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span><span style="top:-2.86199em"><span class="pstrut" style="height:2.606em"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.35000999999999993em"><span></span></span></span></span></span></span><span class="minner"><span class="mopen delimcenter" style="top:0"><span class="delimsizing size1">{</span></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2818857142857143em"><span></span></span></span></span></span></span><span class="mrel mtight">∼</span><span class="mord mtight"><span class="mord mathdefault mtight">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2818857142857143em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.34731999999999996em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">:</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2818857142857143em"><span></span></span></span></span></span></span><span class="mrel mtight">∼</span><span class="mord mtight"><span class="mord mathdefault mtight">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2818857142857143em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.34731999999999996em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord"><span class="mord"><span class="mord mathcal" style="margin-right:.08222em">P</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.6778919999999999em"><span style="top:-2.9890000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0"><span class="delimsizing size1">}</span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.86199em"><span style="top:-2.2559899999999997em"><span class="pstrut" style="height:2.606em"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span><span style="top:-2.86199em"><span class="pstrut" style="height:2.606em"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.35000999999999993em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.7400100000000003em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.00773em">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.00773em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.143em"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">e</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.86199em"><span style="top:-2.2559899999999997em"><span class="pstrut" style="height:2.606em"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span><span style="top:-2.86199em"><span class="pstrut" style="height:2.606em"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.35000999999999993em"><span></span></span></span></span></span></span><span class="minner"><span class="mopen delimcenter" style="top:0"><span class="delimsizing size1">{</span></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">e</span><span class="mrel mtight">∼</span><span class="mord mtight"><span class="mord mathdefault mtight">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2818857142857143em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.34731999999999996em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">:</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">e</span><span class="mrel mtight">∼</span><span class="mord mtight"><span class="mord mathdefault mtight">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2818857142857143em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.34731999999999996em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord"><span class="mord"><span class="mord mathcal" style="margin-right:.08222em">P</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.751892em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0"><span class="delimsizing size1">}</span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.86199em"><span style="top:-2.2559899999999997em"><span class="pstrut" style="height:2.606em"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span><span style="top:-2.86199em"><span class="pstrut" style="height:2.606em"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.35000999999999993em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.102em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.111853em"><span></span></span></span></span></span></span></span></span></span></span></span></p><p>这样就算出了 user-item 兴趣扩散得分矩阵。然后利用矩阵分解，算出这一个元路径(这一种user-item 关系)下的 user vector 和 item vector。<br>综合所有元路径（即综合各种关系），user 对 item 的喜好最后为</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>r</mi><mrow><mo fence="true">(</mo><msub><mi>u</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>e</mi><mi>j</mi></msub><mo fence="true">)</mo></mrow><mo>=</mo><munderover><mo>∑</mo><mrow><mi>q</mi><mo>=</mo><mn>1</mn></mrow><mi>L</mi></munderover><msub><mi>θ</mi><mi>q</mi></msub><mo>⋅</mo><msubsup><mover accent="true"><mi>U</mi><mo>^</mo></mover><mi>i</mi><mrow><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo></mrow></msubsup><msubsup><mover accent="true"><mi>V</mi><mo>^</mo></mover><mi>j</mi><mrow><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo><mi>T</mi></mrow></msubsup></mrow><annotation encoding="application/x-tex">r\left(u_{i}, e_{j}\right)=\sum_{q=1}^{L} \theta_{q} \cdot \hat{U}_{i}^{(q)} \hat{V}_{j}^{(q) T}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-.286108em"></span><span class="mord mathdefault" style="margin-right:.02778em">r</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen delimcenter" style="top:0">(</span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0">)</span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:3.2315570000000005em;vertical-align:-1.403221em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283360000000002em"><span style="top:-1.8828869999999998em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03588em">q</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.0500049999999996em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.300005em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.403221em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.02778em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03588em">q</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.4577719999999998em;vertical-align:-.412972em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.9467699999999999em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.10903em">U</span></span></span><span style="top:-3.25233em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.22222em">^</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em"><span style="top:-2.4231360000000004em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span style="top:-3.2198em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight" style="margin-right:.03588em">q</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.276864em"><span></span></span></span></span></span></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.9467699999999999em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">V</span></span></span><span style="top:-3.25233em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.25em">^</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em"><span style="top:-2.4231360000000004em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span style="top:-3.2198em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight" style="margin-right:.03588em">q</span><span class="mclose mtight">)</span><span class="mord mathdefault mtight" style="margin-right:.13889em">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.412972em"><span></span></span></span></span></span></span></span></span></span></span></p><ol start="2"><li>用户分组训练<br>上面的方法对于所有用户来说，模型都是一样的，训练的时候把所有user-item 都放进去一起训练了，不能从模型的层次做到个性化。原文表示，可能所有用户都喜欢热门物品。<br>解决这个问题可能的办法是：每个用户单独训练，不适用其他 user-item 交互。但是考虑到稀疏性问题，这是不可行的。<br>本文提出：一些用户可能是非常相似的，可以分组分簇来中和上述问题。根据矩阵分解的结果，将用户聚类分组，每一组放在一起训练。注意：一个用户可能属于多个组。这样的话，最后的用户喜爱分数为：</li></ol><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>r</mi><mo>∗</mo></msup><mrow><mo fence="true">(</mo><msub><mi>u</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>e</mi><mi>j</mi></msub><mo fence="true">)</mo></mrow><mo>=</mo><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>c</mi></munderover><mi mathvariant="normal">sim</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><msub><mi>C</mi><mi>k</mi></msub><mo separator="true">,</mo><msub><mi>u</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow><munderover><mo>∑</mo><mrow><mi>q</mi><mo>=</mo><mn>1</mn></mrow><mi>L</mi></munderover><msubsup><mi>θ</mi><mi>q</mi><mrow><mo stretchy="false">{</mo><mi>k</mi><mo stretchy="false">}</mo></mrow></msubsup><mo>⋅</mo><msubsup><mover accent="true"><mi>U</mi><mo>^</mo></mover><mi>i</mi><mrow><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo></mrow></msubsup><msubsup><mover accent="true"><mi>V</mi><mo>^</mo></mover><mi>j</mi><mrow><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo><mi>T</mi></mrow></msubsup></mrow><annotation encoding="application/x-tex">r^{*}\left(u_{i}, e_{j}\right)=\sum_{k=1}^{c} \operatorname{sim}\left(C_{k}, u_{i}\right) \sum_{q=1}^{L} \theta_{q}^{\{k\}} \cdot \hat{U}_{i}^{(q)} \hat{V}_{j}^{(q) T}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.02778em">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.738696em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∗</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen delimcenter" style="top:0">(</span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0">)</span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:3.2315570000000005em;vertical-align:-1.403221em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em"><span style="top:-1.8478869999999998em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.0500049999999996em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.300005em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">c</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.302113em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mop"><span class="mord mathrm">s</span><span class="mord mathrm">i</span><span class="mord mathrm">m</span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen delimcenter" style="top:0">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0">)</span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283360000000002em"><span style="top:-1.8828869999999998em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03588em">q</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.0500049999999996em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.300005em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.403221em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.938em"><span style="top:-2.4530000000000003em;margin-left:-.02778em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03588em">q</span></span></span></span><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">{</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mclose mtight">}</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.383108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.4577719999999998em;vertical-align:-.412972em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.9467699999999999em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.10903em">U</span></span></span><span style="top:-3.25233em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.22222em">^</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em"><span style="top:-2.4231360000000004em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span style="top:-3.2198em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight" style="margin-right:.03588em">q</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.276864em"><span></span></span></span></span></span></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.9467699999999999em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">V</span></span></span><span style="top:-3.25233em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.25em">^</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em"><span style="top:-2.4231360000000004em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span style="top:-3.2198em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight" style="margin-right:.03588em">q</span><span class="mclose mtight">)</span><span class="mord mathdefault mtight" style="margin-right:.13889em">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.412972em"><span></span></span></span></span></span></span></span></span></span></span></p><h1 id="存在的问题"><a class="markdownIt-Anchor" href="#存在的问题"></a> 存在的问题</h1><p>元路径需要预先定义，需要一定的设计经验，而且可能遗漏重要的信息。</p></div><footer class="post-footer"><div class="post-eof"></div></footer></article><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en"><link itemprop="mainEntityOfPage" href="https://hencent.github.io/2020/09/10/36470/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/head.jpg"><meta itemprop="name" content="Binjie Zhang"><meta itemprop="description" content=""></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="PenguinCat's Blog"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/2020/09/10/36470/" class="post-title-link" itemprop="url">CityTransfer: Transferring Inter- and Intra-City Knowledge for Chain Store Site Recommendation based on Multi-Source Urban Data</a></h2><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">Posted on</span> <time title="Created: 2020-09-10 11:07:17 / Modified: 11:50:59" itemprop="dateCreated datePublished" datetime="2020-09-10T11:07:17+08:00">2020-09-10</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/UrbanComputing/" itemprop="url" rel="index"><span itemprop="name">UrbanComputing</span></a></span></span></div></header><div class="post-body" itemprop="articleBody"><h1 id="文章主要解决什么问题"><a href="#文章主要解决什么问题" class="headerlink" title="文章主要解决什么问题"></a>文章主要解决什么问题</h1><p>通过利用 本城市其余同类型店铺的数据 和 本品牌在其余城市的数据，解决连锁店位置推荐的冷启动问题。</p><h1 id="解决的思路是什么"><a href="#解决的思路是什么" class="headerlink" title="解决的思路是什么"></a>解决的思路是什么</h1><ul><li>同品牌连锁店对选址的偏好是相同的，同品牌连锁店的特征也可视为相同的，所以这些信息可以在不同城市间转移。</li><li>城市网格数据编码时的噪声等问题用 Auto-Encoder 缓解。</li><li>城市划分为网格后，不同城市的网格间不便于直接比较，需要借助于相关系数，使得相关系数较高的一对 源/目标 城市编码后在共享语义空间上相似。</li></ul><p><img src="/2020/09/10/36470/fig1.png" alt="fig1"></p><h1 id="核心的知识点有哪些"><a href="#核心的知识点有哪些" class="headerlink" title="核心的知识点有哪些"></a>核心的知识点有哪些</h1><ul><li>MF</li><li>Auto-Encoder<h1 id="模型分块说明"><a href="#模型分块说明" class="headerlink" title="模型分块说明"></a>模型分块说明</h1></li></ul><ol><li>Data preparation<br>提取城市网格的 Geographic features 和 Commercial features</li><li>Transfer Rating Prediction Model<br>连锁企业的特征 u 和对位置的偏好 b 通常是固定的，所以可以在城市间转移。通过矩阵分解提取 vector。<br>评分预测是 $r_{i j}=b_{i}+e_{j}^{(s)}+u_{i}^{T} v_{j}^{(s)}$ （目标城市的评分类似）<br>目标函数是 $O_{1}=\sum_{r_{y}^{(i)} \in R^{(l)}}\left(r_{i j}^{(t)}-r_{i j}^{(t)}\right)^{2}+\lambda_{1} \sum_{r_{l}^{(s)} \in R^{(s)}}\left(r_{i j}^{(s)}-r_{i j}^{(s)}\right)^{2}$</li><li><p>Intra-City Semantic Extraction<br>提取到的城市网格数据是嘈杂的，可以用 Auto-Encoder 提取出高质量的信息 v。</p><script type="math/tex;mode=display">\begin{array}{l}
v_{j}^{(s)}=\sigma\left(W^{(s)} f_{j}^{(s)}+y_{1}^{(s)}\right) \\
v_{j}^{(t)}=\sigma\left(W^{(t)} f_{j}^{(t)}+y_{1}^{(t)}\right)
\end{array}</script><script type="math/tex;mode=display">\begin{array}{l}
\hat{f}_{j}^{(s)}=\sigma\left(W^{(s) T} v_{j}^{(s)}+y_{2}^{(s)}\right) \\
\hat{f}_{j}^{(t)}=\sigma\left(W^{(t) T} v_{j}^{(t)}+y_{2}^{(t)}\right)
\end{array}</script><script type="math/tex;mode=display">O_{3}=\sum_{j=1}^{m_{1}}\left\|f_{j}-f_{j}^{(s)}\right\|+\sum_{j=1}^{m_{2}}\left\|f_{j}^{(t)}-f_{j}^{(t)}\right\|</script></li><li><p>Inter-City Knowledge Association<br>不同城市间，相关度较高的那些网格经过编码后在共享语义空间上应该是相近的。这个相近程度也要参考相关度。</p><script type="math/tex;mode=display">\rho\left(f_{j}^{(s)}, f_{l}^{(t)}\right)=\frac{\sum_{i=1}^{k}\left(f_{j, i}^{(s)}-f_{j}^{(s)}\right)\left(f_{l, i}^{(t)}-f_{l}^{(t)}\right)}{\sqrt{\sum_{i=1}^{k}\left(f_{j, i}^{(s)}-\bar{f}_{j}^{(s)}\right)^{2} \sum_{i=1}^{k}\left(f_{l, i}^{(t)}-\bar{f}_{l}^{(t)}\right)^{2}}}</script><script type="math/tex;mode=display">O_{2}=\sum_{\left(g_{j}^{(s)}, g_{j}^{(t)}\right) \in \Delta} \rho\left(f_{j}^{(s)}, f_{l}^{(t)}\right)\left(v_{j}^{(s)}-v_{j}^{(t)}\right)^{2}</script></li></ol><h1 id="存在的问题"><a href="#存在的问题" class="headerlink" title="存在的问题"></a>存在的问题</h1><p>似乎用住客的评分作为选址好坏与否的标准不太合理。给连锁店铺推荐选址是为了让店铺获得较高收益。所以这个推荐的受众可能不太合适。</p><h1 id="有哪些改进的思路"><a href="#有哪些改进的思路" class="headerlink" title="有哪些改进的思路"></a>有哪些改进的思路</h1><p>可以考虑使用店铺入住次数作为评判准测。</p></div><footer class="post-footer"><div class="post-eof"></div></footer></article><nav class="pagination"><span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="Next page"></i></a></nav></div><script>window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc">Table of Contents</li><li class="sidebar-nav-overview">Overview</li></ul><div class="post-toc-wrap sidebar-panel"></div><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" alt="Binjie Zhang" src="/images/head.jpg"><p class="site-author-name" itemprop="name">Binjie Zhang</p><div class="site-description" itemprop="description"></div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">19</span> <span class="site-state-item-name">posts</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/"><span class="site-state-item-count">4</span> <span class="site-state-item-name">categories</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/"><span class="site-state-item-count">11</span> <span class="site-state-item-name">tags</span></a></div></nav></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://gitee.com/" title="Gitee → https:&#x2F;&#x2F;gitee.com&#x2F;" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>Gitee</a> </span><span class="links-of-author-item"><a href="https://git.code.tencent.com/u/PenguinZhang" title="腾讯工蜂 → https:&#x2F;&#x2F;git.code.tencent.com&#x2F;u&#x2F;PenguinZhang" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>腾讯工蜂</a> </span><span class="links-of-author-item"><a href="https://penguinzhang.coding.net/" title="Coding → https:&#x2F;&#x2F;penguinzhang.coding.net&#x2F;" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>Coding</a> </span><span class="links-of-author-item"><a href="https://github.com/yourname" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;yourname" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a> </span><span class="links-of-author-item"><a href="mailto:zhangbinjie471621762@gmail.com" title="E-Mail → mailto:zhangbinjie471621762@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a></span></div></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright">&copy; <span itemprop="copyrightYear">2020</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">Binjie Zhang</span></div><div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a></div></div></footer></div><script src="/lib/anime.min.js"></script><script src="/lib/velocity/velocity.min.js"></script><script src="/lib/velocity/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/pisces.js"></script><script src="/js/next-boot.js"></script><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/katex@0/dist/katex.min.css"></body></html>